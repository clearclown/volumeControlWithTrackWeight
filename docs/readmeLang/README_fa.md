<div dir="rtl">

# Gravity Volume Control ๐ชจ๐

[![Platform](https://img.shields.io/badge/platform-macOS%2013.0+-blue.svg)](https://www.apple.com/macos/)
[![Swift](https://img.shields.io/badge/Swift-6.0-orange.svg)](https://swift.org/)
[![Tests](https://img.shields.io/badge/tests-48%20passed-brightgreen.svg)](#ุชุณุช)
[![License](https://img.shields.io/badge/license-MIT-lightgrey.svg)](../../LICENSE)

**๐ [English](../../README.md) | [ๆฅๆฌ่ช](README_ja.md) | [็ฎไฝไธญๆ](README_zh-CN.md) | [็น้ซไธญๆ](README_zh-TW.md) | [ะัััะบะธะน](README_ru.md) | [ุงูุนุฑุจูุฉ](README_ar.md)**

**ุชุฑฺฉโูพุฏ ูฺฉโุจูฺฉ ุฎูุฏ ุฑุง ุจู ยซูุงฺฉุงุฑุขูุฏุชุฑู ฺฉูุชุฑูโฺฉููุฏู ุตุฏุง ุฌูุงูยป ุชุจุฏู ฺฉูุฏ**

[Gravity Volume Control] ฺฉ ุงูพูฺฉุดู ุทูุฒ ุงุณุช ฺฉู ุงุฒ ุณูุณูุฑ ูุดุงุฑ Force Touch ุชุนุจูโุดุฏู ุฏุฑ ุชุฑฺฉโูพุฏ ูฺฉโุจูฺฉ ุงุณุชูุงุฏู ูโฺฉูุฏ ุชุง **ุตุฏุง ุณุณุชู ุฑุง ุจุง ูุฒู ุงุดุงุก ูุฑุงุฑ ุฏุงุฏู ุดุฏู ุฑู ุขู ฺฉูุชุฑู ฺฉูุฏ**.

ุงู ุจุฑูุงูู ุจู ุนููุงู ุงุฏุง ุงุญุชุฑุงู ุจู ูุณุงุจูู ูุญุจูุจ ยซุจุฏุชุฑู ุฑุงุจุท ฺฉุงุฑุจุฑ ฺฉูุชุฑู ุตุฏุงยป ุฏุฑ ุฌุงูุนู ูููุฏุณู ุชูุณุนู ุฏุงุฏู ุดุฏู ุงุณุช.

https://github.com/user-attachments/assets/demo-video-placeholder

---

## ููุฑุณุช ูุทุงูุจ

- [ูุญูู ุงุณุชูุงุฏู](#ูุญูู-ุงุณุชูุงุฏู-the-bad-experience)
- [ูพุดโูุงุฒูุง](#ูพุด-ูุงุฒูุง)
- [ูุตุจ](#ูุตุจ)
- [ุชูุณุนู](#ุชูุณุนู)
- [ูุนูุงุฑ](#ูุนูุงุฑ)
- [ุณุงุฎุชุงุฑ ูพุฑูฺู](#ุณุงุฎุชุงุฑ-ูพุฑูฺู)
- [ูุฑุตุชโูุง ุงุฏฺฏุฑ](#ูุฑุตุช-ูุง-ุงุฏฺฏุฑ-for-engineers)
- [ุณูุจ ูุณุฆููุช](#ุณูุจ-ูุณุฆููุช)

---

## ูุญูู ุงุณุชูุงุฏู (The "Bad" Experience)

1. ุงูพูฺฉุดู ุฑุง ุงุฌุฑุง ฺฉูุฏ.
2. ุงูฺฏุดุช ุฎูุฏ ุฑุง ุฑู ุชุฑฺฉโูพุฏ ูุฑุงุฑ ุฏูุฏ (ุจุฑุง ุฑุณุงูุง ุงูฺฉุชุฑฺฉ ุถุฑูุฑ ุงุณุช).
3. ฺฉ **ยซูุฒููยป** ุฑุง ฺฉูุงุฑ ุงูฺฏุดุช ุฎูุฏ ูุฑุงุฑ ุฏูุฏ.
   - ๐ชถ **ุงุดุงุก ุณุจฺฉ (ูุซุงู: ูพุงฺฉโฺฉู)** โ ๐ ุตุฏุง: ฺฉู
   - ๐บ **ุงุดุงุก ุณูฺฏู (ูุซุงู: ููุงู ูพุฑ)** โ ๐ ุตุฏุง: ุฒุงุฏ
4. ุฏุฑ ุญู ุชูุงุดุง ูุฏูุ **ุดุก ุณูฺฏู ุฑุง ุชูุงู ูุฏุช ุฑู ุชุฑฺฉโูพุฏ ูฺฏู ุฏุงุฑุฏ**. ุงฺฏุฑ ุขู ุฑุง ุจุฑุฏุงุฑุฏุ ุตุฏุง ููุฑุงู ูุทุน ูโุดูุฏ.

---

## ูพุดโูุงุฒูุง

| ููุฑุฏ | ูุงุฒ |
|------|------|
| ุณุณุชูโุนุงูู | macOS 13.0 (Ventura) ุง ุจุงูุงุชุฑ |
| ุณุฎุชโุงูุฒุงุฑ | ูฺฉโุจูฺฉ ุจุง ุชุฑฺฉโูพุฏ Force Touch |
| Xcode | 16.0 ุง ุจุงูุงุชุฑ |
| Swift | 6.0 |

> **ุชูุฌู:** ุจุง ุชุฑฺฉโูพุฏูุง ุฎุงุฑุฌ ุง Magic Trackpad ฺฉุงุฑ ููโฺฉูุฏ. ููุท ุงุฒ ุชุฑฺฉโูพุฏ ุฏุงุฎู ูฺฉโุจูฺฉ ูพุดุชุจุงู ูโฺฉูุฏ.

---

## ูุตุจ

### Homebrew (ุชูุตู ุดุฏู)

<div dir="ltr">

```bash
brew install --cask gravity-volume-control
```

</div>

### ูุตุจ ุฏุณุช

1. ุขุฎุฑู ูุณุฎู `.dmg` ุฑุง ุงุฒ [Releases](https://github.com/clearclown/volumeControlWithTrackWeight/releases) ุฏุงูููุฏ ฺฉูุฏ
2. `Gravity Volume Control.app` ุฑุง ุจู `/Applications` ุจฺฉุดุฏ
3. ุฏุฑ ุงููู ุงุฌุฑุงุ ุงฺฏุฑ ูพุงู ยซุชูุณุนูโุฏููุฏู ูุงุจู ุชุฃุฏ ูุณุชยป ุฑุง ุฏุฏุฏุ ุจู ุชูุธูุงุช ุณุณุชู > ุญุฑู ุฎุตูุต ู ุงููุช ุจุฑูุฏ ู ุงุฌุงุฒู ุฏูุฏ

### ุณุงุฎุช ุงุฒ ุณูุฑุณ

<div dir="ltr">

```bash
git clone https://github.com/clearclown/volumeControlWithTrackWeight.git
cd volumeControlWithTrackWeight
xcodebuild build -scheme TrackWeight -destination 'platform=macOS'
```

</div>

---

## ุชูุณุนู

### ููุณูู ุชูุณุนู

ุงู ูพุฑูฺู ุงุฒ **TDD (ุชูุณุนู ุชุณุชโูุญูุฑ)** ูพุฑู ูโฺฉูุฏ.

- ููฺฏุงู ุงุถุงูู ฺฉุฑุฏู ูฺฺฏโูุง ุฌุฏุฏุ ุงุจุชุฏุง ุชุณุชโูุง ููุดุชู ูโุดููุฏ
- ููููุช ุชุณุช ุงูููุช ุจุงูุงุชุฑ ุงุฒ ุชุณุช ุฏุณุช ุฑู ุฏุณุชฺฏุงู ุฏุงุฑุฏ
- ViewModelูุง ุงุฒ ุชุฒุฑู ูุงุจุณุชฺฏ (DI) ุจุฑุง ุทุฑุงุญ ูุงุจู ุชุณุช ุงุณุชูุงุฏู ูโฺฉููุฏ

### ุณุงุฎุช

<div dir="ltr">

```bash
# ุณุงุฎุช ุงูพูฺฉุดู
xcodebuild build -scheme TrackWeight -destination 'platform=macOS' \
  CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO CODE_SIGNING_ALLOWED=NO
```

</div>

### ุชุณุช

<div dir="ltr">

```bash
# ุงุฌุฑุง ููู ุชุณุชโูุง
xcodebuild test -scheme TrackWeight -destination 'platform=macOS' \
  -only-testing:TrackWeightTests \
  CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO CODE_SIGNING_ALLOWED=NO
```

</div>

**ูพูุดุด ุชุณุช:**

| ูุฌููุนู ุชุณุช | ุชุนุฏุงุฏ ุชุณุช | ูุฏู |
|------------|-----------|------|
| `ScaleViewModelTests` | 17 | ุนููฺฉุฑุฏ ูพุงู ุชุฑุงุฒู |
| `WeighingViewModelTests` | 24 | ุฌุฑุงู ฺฉุงุฑ ูุฒูโฺฉุด ู ุงูุชูุงู ุญุงูุช |
| `WeighingStateTests` | 7 | ุจุฑุงุจุฑ ุญุงูุช |
| **ูุฌููุน** | **48** | - |

### ูพุดุชุจุงู ุชูุณุนู ุจุง ููุด ูุตููุน

ููฺฏุงู ุชูุณุนู ุจุง ุฏุณุชุงุฑุงู ููุด ูุตููุน (Claude Code ู ุบุฑู)ุ ุจู `CLAUDE.md` ุจุฑุง ููุงูู TDD ู ุฑุงูููุงูุง ูุฑุงุฌุนู ฺฉูุฏ.

---

## ูุนูุงุฑ

ุงู ุงูพูฺฉุดู ุงุฒ ุงูฺฏู **MVVM (Model-View-ViewModel)** ุจุฑุง ุงูุนฺฉุงุณ ูุงฺฉูุด ูุฑูุฏ ุณุฎุชโุงูุฒุงุฑ ุจู UI ู ุชูุธูุงุช ุณุณุชู ุงุณุชูุงุฏู ูโฺฉูุฏ.

<div dir="ltr">

```mermaid
graph TD
    Hardware[ุณูุณูุฑูุง ูุดุงุฑ ุชุฑฺฉโูพุฏ] -->|ุฏุงุฏู ูุดุงุฑ ุฎุงู| OMS[ูุฑูโูุฑฺฉ OpenMultitouchSupport]
    OMS -->|ุฌุฑุงู ุบุฑููุฒูุงู| VM[ScaleViewModel / WeighingViewModel]

    subgraph "ููุทู ุงูพูฺฉุดู"
        VM -->|ูพุฑุฏุงุฒุด ุณฺฏูุงู| Logic[ุตุงูโุณุงุฒ ู ูฺฏุงุดุช]
        Logic -->|ุตุฏุง ูุญุงุณุจูโุดุฏู| PublishedVar[@Published volume]
    end

    PublishedVar -->|ุงุชุตุงู| View[SwiftUI View]
    PublishedVar -->|ุงุซุฑ ุฌุงูุจ| AudioAPI[ุตุฏุง ุณุณุชู macOS]
```

</div>

### ุฌุฑุงู ุฏุงุฏู

1. **ููุจุน ุฏุงุฏู:** `OpenMultitouchSupport` ููููโูุง ุณุฎุชโุงูุฒุงุฑ ุฑุง ฺฏุฑูุชู ู ุฑูุฏุงุฏูุง ููุณ ุชููุฏ ูโฺฉูุฏ.
2. **ViewModel:** `ScaleViewModel` ุฏุงุฏูโูุง ุฑุง ุงุฒ ุทุฑู ุฌุฑุงู ุบุฑููุฒูุงู (`for await`) ุฏุฑุงูุช ูโฺฉูุฏุ ฺฉุงูุด ููุฒ ู ุชุจุฏู ููุงุฏุฑ (ูุดุงุฑ 0.0~1.0 โ ุตุฏุง 0.0~100.0) ุฑุง ุงูุฌุงู ูโุฏูุฏ.
3. **View:** SwiftUI ุชุบุฑุงุช ูฺฺฏ `@Published` ุฑุง ุชุดุฎุต ุฏุงุฏู ู ยซุงููุดูโูุง ุณูฺฏูโููุงยป ุฑุง ุฑูุฏุฑ ูโฺฉูุฏ.
4. **ุณุณุชู:** ููุฒูุงู ุตุฏุง ุณุณุชู ุฑุง ุฏุฑ ูพุณโุฒููู ุจูโุฑูุฒ ูโฺฉูุฏ.

### ุชุฒุฑู ูุงุจุณุชฺฏ (DI)

ViewModelูุง ุจุฑุง ูุงุจูุช ุชุณุช ุทุฑุงุญ ุดุฏูโุงูุฏ:

<div dir="ltr">

```swift
// ุชููุฏ (ูพุดโูุฑุถ)
let viewModel = ScaleViewModel() // ุงุณุชูุงุฏู ุงุฒ OMSManager.shared

// ุชุณุช
let mockProvider = MockTouchDataProvider()
let viewModel = ScaleViewModel(touchProvider: mockProvider)
```

</div>

---

## ุณุงุฎุชุงุฑ ูพุฑูฺู

<div dir="ltr">

```
volumeControlWithTrackWeight/
โโโ TrackWeight/                    # ุงูพูฺฉุดู ุงุตู
โ   โโโ TrackWeightApp.swift        # ููุทู ูุฑูุฏ
โ   โโโ ContentView.swift           # ุตูุญู ุงุตู
โ   โโโ ScaleView.swift             # ุฑุงุจุท ฺฉุงุฑุจุฑ ุชุฑุงุฒู
โ   โโโ ScaleViewModel.swift        # ููุทู ุชุฑุงุฒู
โ   โโโ WeighingView.swift          # ุฑุงุจุท ฺฉุงุฑุจุฑ ูุฒูโฺฉุด
โ   โโโ WeighingViewModel.swift     # ุฌุฑุงู ฺฉุงุฑ ูุฒูโฺฉุด
โ   โโโ WeighingState.swift         # ุชุนุฑู ุญุงูุชโูุง
โ   โโโ TouchDataProviding.swift    # ูพุฑูุชฺฉู DI
โ
โโโ TrackWeightTests/               # ุชุณุชโูุง ูุงุญุฏ
โ   โโโ Mocks/
โ   โ   โโโ MockTouchDataProvider.swift
โ   โโโ ScaleViewModelTests.swift
โ   โโโ WeighingViewModelTests.swift
โ   โโโ WeighingStateTests.swift
โ
โโโ CLAUDE.md                       # ุฑุงูููุง ุชูุณุนู ุจุง AI
โโโ README.md
```

</div>

---

## ูุฑุตุชโูุง ุงุฏฺฏุฑ (For Engineers)

ุฏุฑ ูฺฏุงู ุงูู ุงู ููุท ฺฉ ุงูพูฺฉุดู ุทูุฒ ุงุณุชุ ุงูุง ฺุงูุดโูุง ูู ูพุดุฑูุชูโุง ุฏุงุฑุฏ. ุจู ุนููุงู ฺฉ ูููุฏุณ Swiftุ ูโุชูุงูุฏ ููุงุฑุฏ ุฒุฑ ุฑุง ุนููุงู ุงุฏ ุจฺฏุฑุฏ:

### 1. APIูุง ุฎุตูุต Apple ู ฺฉูุชุฑู ุณุฎุชโุงูุฒุงุฑ

ุงุฏ ุจฺฏุฑุฏ ฺฺฏููู ูุฑูโูุฑฺฉ ุฎุตูุต `OpenMultitouchSupport` ุฑุง ุชุญูู ู ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ุจู ุฏุงุฏูโูุง ุฎุงู ุชุฑฺฉโูพุฏ (ูุดุงุฑุ ูุณุงุญุช ุชูุงุณ) ฺฉู ูุนูููุงู ุบุฑูุงุจู ุฏุณุชุฑุณ ูุณุชูุฏุ ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏ.

- **ูุงูโูุง ฺฉูุฏ:** `ContentViewModel.swift`, `TouchDataProviding.swift`

### 2. ููุฒูุงู ูุฏุฑู Swift (Async/Await)

ูพุฑุฏุงุฒุด ฺฉุงุฑุขูุฏ ุฌุฑุงูโูุง ุฏุงุฏู ูุฏุงูู ุงุฒ ุณูุณูุฑูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฌุฏุฏุชุฑู ูุฏู ููุฒูุงู Swift 6.0.

- ูุธุงุฑุช ุจุฑ ุฑูุฏุงุฏ ุจุง `AsyncStream`
- ุงุชุตุงู ุฏุงุฏู ุงูู ุจู ุชุฑุฏ UI ุจุง `Task` ู `@MainActor`
- **ูุงูโูุง ฺฉูุฏ:** `ScaleViewModel.swift`, `WeighingViewModel.swift`

### 3. ูพุฑุฏุงุฒุด ุณฺฏูุงู

ููุงุฏุฑ ุฎุงู ุณูุณูุฑ ุฏุงุฆูุงู ููุณุงู ุฏุงุฑูุฏ (ููุฒ). ุดุงูู ูพุงุฏูโุณุงุฒ ุงูฺฏูุฑุชูโูุง ุจุฑุง ุชุจุฏู ุขู ุจู ุชุบุฑุงุช ุตุฏุง ุตุงู ู ุฑุงุญุช ุงุณุช.

| ูพุงุฑุงูุชุฑ | ููุฏุงุฑ | ุชูุถุญ |
|---------|-------|-------|
| `historySize` | 10 | ุงูุฏุงุฒู ูพูุฌุฑู ูุงูฺฏู ูุชุญุฑฺฉ |
| `rateOfChangeThreshold` | 5.0 | ุขุณุชุงูู ูุฑุฎ ุชุดุฎุต ุดุก |
| `stabilityThreshold` | 2.0 | ุชุญูู ูุถุงูุช ูพุงุฏุงุฑ |
| `fingerHoldDuration` | 3.0 ุซุงูู | ุฒูุงู ุงูุชุธุงุฑ ุชุดุฎุต ุงูฺฏุดุช |
| `stabilityDuration` | 3.0 ุซุงูู | ุฒูุงู ุงูุชุธุงุฑ ูพุงุฏุงุฑ |

- **ูุงูโูุง ฺฉูุฏ:** `WeighingViewModel.swift`

### 4. ฺฉูพุงุฑฺฺฏ ุณุณุชู macOS

ุฏุฑ ููุฑุฏ ฺฉูพุงุฑฺฺฏ ุจุง `AudioToolbox` ู `Core Audio` ุจุฑุง ฺฉูุชุฑู ุตุฏุง ุงุตู ฺฉู ุณุณุชูุ ู ูุฏุฑุช ูุฌูุฒูุง ุฏุฑ ูุญุท sandbox (`entitlements`) ุงุฏ ุจฺฏุฑุฏ.

### 5. ูุนูุงุฑ ูุงุจู ุชุณุช

ุงูฺฏููุง ุทุฑุงุญ ุฑุง ุงุฏ ุจฺฏุฑุฏ ฺฉู ุชุณุช ูุงุญุฏ ุฑุง ุญุช ุจุฑุง ฺฉุฏูุง ูุงุจุณุชู ุจู APIูุง ุฎุตูุต ุงุฒ ุทุฑู ุงูุชุฒุงุน ูพุฑูุชฺฉู ู ุชุฒุฑู ูุงุจุณุชฺฏ ููฺฉู ูโุณุงุฒูุฏ.

<div dir="ltr">

```swift
protocol TouchDataProviding: AnyObject, Sendable {
    var touchDataStream: AsyncStream<[OMSTouchData]> { get }
    @MainActor func startListening() -> Bool
    @MainActor func stopListening() -> Bool
}
```

</div>

---

## ูุดุงุฑฺฉุช

1. ุงู ูุฎุฒู ุฑุง Fork ฺฉูุฏ
2. ฺฉ ุดุงุฎู ูฺฺฏ ุจุณุงุฒุฏ (`git checkout -b feature/amazing-feature`)
3. **ุงุจุชุฏุง ุชุณุชโูุง ุฑุง ุจููุณุฏ** ุณูพุณ ูพุงุฏูโุณุงุฒ ฺฉูุฏ
4. ูุทูุฆู ุดูุฏ ููู ุชุณุชโูุง ูพุงุณ ูโุดููุฏ (`xcodebuild test ...`)
5. ุชุบุฑุงุช ุฎูุฏ ุฑุง commit ฺฉูุฏ (`git commit -m 'Add amazing feature'`)
6. ุดุงุฎู ุฑุง push ฺฉูุฏ (`git push origin feature/amazing-feature`)
7. ฺฉ Pull Request ุจุณุงุฒุฏ

---

## ุณูุจ ูุณุฆููุช

> **ูุดุฏุงุฑ:** ุงุดุงุก ุจุด ุงุฒ ุญุฏ ุณูฺฏู ุง ุชุฒ ุฑู ุชุฑฺฉโูพุฏ ูุฑุงุฑ ูุฏูุฏ. ุงู ููฺฉู ุงุณุช ุจู ุชุฑฺฉโูพุฏ ุดูุง ุขุณุจ ุจุฑุณุงูุฏ. ุชูุณุนูโุฏููุฏู ูฺ ูุณุฆููุช ุฏุฑ ูุจุงู ุขุณุจโูุง ุณุฎุชโุงูุฒุงุฑ ูุงุด ุงุฒ ุงุณุชูุงุฏู ุงุฒ ุงู ุงูพูฺฉุดู ูุฏุงุฑุฏ.

**ุงู ฺฉ ุดูุฎ ุงุณุช. ูุทูุงู ุจุฑุง ูุนุงูุชโูุง ุฑูุฒุงูู ุงุณุชูุงุฏู ูฺฉูุฏ.**

---

## ูุฌูุฒ

MIT License - ุจุฑุง ุฌุฒุฆุงุช ุจู [LICENSE](../../LICENSE) ูุฑุงุฌุนู ฺฉูุฏ.

</div>
