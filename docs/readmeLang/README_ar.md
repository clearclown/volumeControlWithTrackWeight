<div dir="rtl">

# Gravity Volume Control ๐ชจ๐

[![Platform](https://img.shields.io/badge/platform-macOS%2013.0+-blue.svg)](https://www.apple.com/macos/)
[![Swift](https://img.shields.io/badge/Swift-6.0-orange.svg)](https://swift.org/)
[![Tests](https://img.shields.io/badge/tests-48%20passed-brightgreen.svg)](#ุงูุงุฎุชุจุงุฑ)
[![License](https://img.shields.io/badge/license-MIT-lightgrey.svg)](../../LICENSE)

**๐ [English](../../README.md) | [ๆฅๆฌ่ช](README_ja.md) | [็ฎไฝไธญๆ](README_zh-CN.md) | [็น้ซไธญๆ](README_zh-TW.md) | [ะัััะบะธะน](README_ru.md) | [ูุงุฑุณ](README_fa.md)**

**ุญููู ููุญุฉ ุงูุชุชุจุน ูู MacBook ุงูุฎุงุต ุจู ุฅูู "ุฃุณูุฃ ูุญุฏุฉ ุชุญูู ูู ุงูุตูุช ูู ุงูุนุงูู"**

[Gravity Volume Control] ูู ุชุทุจูู ููุงูู ูุณุชุฎุฏู ูุณุชุดุนุฑ ุงูุถุบุท Force Touch ุงููุฏูุฌ ูู ููุญุงุช ุชุชุจุน MacBook **ููุชุญูู ูู ุตูุช ุงููุธุงู ูู ุฎูุงู ูุฒู ุงูุฃุดูุงุก ุงูููุถูุนุฉ ุนููู**.

ุชู ุชุทููุฑู ุชูุฑููุงู ููุณุงุจูุฉ "ุฃุณูุฃ ูุงุฌูุฉ ูุณุชุฎุฏู ููุชุญูู ูู ุงูุตูุช" ุงูุดููุฑุฉ ูู ูุฌุชูุน ุงููููุฏุณูู.

https://github.com/user-attachments/assets/demo-video-placeholder

---

## ุฌุฏูู ุงููุญุชููุงุช

- [ููููุฉ ุงูุงุณุชุฎุฏุงู](#ููููุฉ-ุงูุงุณุชุฎุฏุงู-the-bad-experience)
- [ุงููุชุทูุจุงุช](#ุงููุชุทูุจุงุช)
- [ุงูุชุซุจูุช](#ุงูุชุซุจูุช)
- [ุงูุชุทููุฑ](#ุงูุชุทููุฑ)
- [ุงูุจููุฉ ุงููุนูุงุฑูุฉ](#ุงูุจููุฉ-ุงููุนูุงุฑูุฉ)
- [ูููู ุงููุดุฑูุน](#ูููู-ุงููุดุฑูุน)
- [ูุฑุต ุงูุชุนูู](#ูุฑุต-ุงูุชุนูู-for-engineers)
- [ุฅุฎูุงุก ุงููุณุคูููุฉ](#ุฅุฎูุงุก-ุงููุณุคูููุฉ)

---

## ููููุฉ ุงูุงุณุชุฎุฏุงู (The "Bad" Experience)

1. ูู ุจุชุดุบูู ุงูุชุทุจูู.
2. ุถุน ุฅุตุจุนู ุนูู ููุญุฉ ุงูุชุชุจุน (ูุทููุจ ููุชูุตูู ุงูููุฑุจุงุฆู).
3. ุถุน **"ุซููุงู"** ุจุฌุงูุจ ุฅุตุจุนู.
   - ๐ชถ **ุฃุดูุงุก ุฎูููุฉ (ูุซุงู: ููุญุงุฉ)** โ ๐ ุงูุตูุช: ููุฎูุถ
   - ๐บ **ุฃุดูุงุก ุซูููุฉ (ูุซุงู: ููุจ ููุชูุฆ)** โ ๐ ุงูุตูุช: ุนุงูู
4. **ุฃุจูู ุฐูู ุงูุดูุก ุงูุซููู ุนูู ููุญุฉ ุงูุชุชุจุน ุทูุงู ุงูููุช** ุฃุซูุงุก ูุดุงูุฏุฉ ุงูููุฏูู. ุฅุฐุง ุฃุฒูุชูุ ุณูุชู ูุชู ุงูุตูุช ููุฑุงู.

---

## ุงููุชุทูุจุงุช

| ุงูุนูุตุฑ | ุงููุชุทูุจ |
|--------|---------|
| ูุธุงู ุงูุชุดุบูู | macOS 13.0 (Ventura) ุฃู ุฃุญุฏุซ |
| ุงูุฃุฌูุฒุฉ | MacBook ูุน ููุญุฉ ุชุชุจุน Force Touch |
| Xcode | 16.0 ุฃู ุฃุญุฏุซ |
| Swift | 6.0 |

> **ููุงุญุธุฉ:** ูุง ูุนูู ูุน ููุญุงุช ุงูุชุชุจุน ุงูุฎุงุฑุฌูุฉ ุฃู Magic Trackpad. ูุฏุนู ููุท ููุญุฉ ุงูุชุชุจุน ุงููุฏูุฌุฉ ูู MacBook.

---

## ุงูุชุซุจูุช

### Homebrew (ููุตู ุจู)

<div dir="ltr">

```bash
brew install --cask gravity-volume-control
```

</div>

### ุงูุชุซุจูุช ุงููุฏูู

1. ูู ุจุชูุฒูู ุฃุญุฏุซ ููู `.dmg` ูู [Releases](https://github.com/clearclown/volumeControlWithTrackWeight/releases)
2. ุงุณุญุจ `Gravity Volume Control.app` ุฅูู `/Applications`
3. ุนูุฏ ุงูุชุดุบูู ุงูุฃููุ ุฅุฐุง ุฑุฃูุช "ูุง ูููู ุงูุชุญูู ูู ุงููุทูุฑ"ุ ุงูุชูู ุฅูู ุฅุนุฏุงุฏุงุช ุงููุธุงู > ุงูุฎุตูุตูุฉ ูุงูุฃูุงู ูุงุณูุญ ุจู

### ุงูุจูุงุก ูู ุงููุตุฏุฑ

<div dir="ltr">

```bash
git clone https://github.com/clearclown/volumeControlWithTrackWeight.git
cd volumeControlWithTrackWeight
xcodebuild build -scheme TrackWeight -destination 'platform=macOS'
```

</div>

---

## ุงูุชุทููุฑ

### ููุณูุฉ ุงูุชุทููุฑ

ูุชุจุน ูุฐุง ุงููุดุฑูุน **TDD (ุงูุชุทููุฑ ุงููุงุฆู ุนูู ุงูุงุฎุชุจุงุฑ)**.

- ุงูุชุจ ุงูุงุฎุชุจุงุฑุงุช ุฃููุงู ุนูุฏ ุฅุถุงูุฉ ููุฒุงุช ุฌุฏูุฏุฉ
- ูุฌุงุญ ุงูุงุฎุชุจุงุฑ ูู ุฃููููุฉ ุนูู ุงูุงุฎุชุจุงุฑ ุงููุฏูู ุนูู ุงูุฌูุงุฒ
- ุชุณุชุฎุฏู ViewModels ุญูู ุงูุชุจุนูุฉ (DI) ููุชุตููู ุงููุงุจู ููุงุฎุชุจุงุฑ

### ุงูุจูุงุก

<div dir="ltr">

```bash
# ุจูุงุก ุงูุชุทุจูู
xcodebuild build -scheme TrackWeight -destination 'platform=macOS' \
  CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO CODE_SIGNING_ALLOWED=NO
```

</div>

### ุงูุงุฎุชุจุงุฑ

<div dir="ltr">

```bash
# ุชุดุบูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช
xcodebuild test -scheme TrackWeight -destination 'platform=macOS' \
  -only-testing:TrackWeightTests \
  CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO CODE_SIGNING_ALLOWED=NO
```

</div>

**ุชุบุทูุฉ ุงูุงุฎุชุจุงุฑ:**

| ูุฌููุนุฉ ุงูุงุฎุชุจุงุฑ | ุนุฏุฏ ุงูุงุฎุชุจุงุฑุงุช | ุงููุฏู |
|-----------------|----------------|-------|
| `ScaleViewModelTests` | 17 | ูุธุงุฆู ุงูููุฒุงู ุงูุฃุณุงุณูุฉ |
| `WeighingViewModelTests` | 24 | ุณูุฑ ุนูู ุงููุฒู ูุงูุชูุงูุงุช ุงูุญุงูุฉ |
| `WeighingStateTests` | 7 | ุชุณุงูู ุงูุญุงูุฉ |
| **ุงููุฌููุน** | **48** | - |

### ุฏุนู ุงูุชุทููุฑ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู

ุนูุฏ ุงูุชุทููุฑ ูุน ูุณุงุนุฏู ุงูุฐูุงุก ุงูุงุตุทูุงุนู (Claude Codeุ ุฅูุฎ)ุ ุฑุงุฌุน `CLAUDE.md` ููุงุทูุงุน ุนูู ููุงุนุฏ TDD ูุงูุฅุฑุดุงุฏุงุช.

---

## ุงูุจููุฉ ุงููุนูุงุฑูุฉ

ูุณุชุฎุฏู ูุฐุง ุงูุชุทุจูู ููุท **MVVM (Model-View-ViewModel)** ูุนูุณ ุฅุฏุฎุงู ุงูุฃุฌูุฒุฉ ุจุดูู ุชูุงุนูู ุนูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ูุฅุนุฏุงุฏุงุช ุงููุธุงู.

<div dir="ltr">

```mermaid
graph TD
    Hardware[ูุณุชุดุนุฑุงุช ุถุบุท ููุญุฉ ุงูุชุชุจุน] -->|ุจูุงูุงุช ุงูุถุบุท ุงูุฎุงู| OMS[ุฅุทุงุฑ ุนูู OpenMultitouchSupport]
    OMS -->|ุชุฏูู ุบูุฑ ูุชุฒุงูู| VM[ScaleViewModel / WeighingViewModel]

    subgraph "ููุทู ุงูุชุทุจูู"
        VM -->|ูุนุงูุฌุฉ ุงูุฅุดุงุฑุฉ| Logic[ุงูุชูุนูู ูุงูุชุนููู]
        Logic -->|ุงูุตูุช ุงููุญุณูุจ| PublishedVar[@Published volume]
    end

    PublishedVar -->|ุงูุฑุจุท| View[SwiftUI View]
    PublishedVar -->|ุงูุชุฃุซูุฑ ุงูุฌุงูุจู| AudioAPI[ุตูุช ูุธุงู macOS]
```

</div>

### ุชุฏูู ุงูุจูุงูุงุช

1. **ูุตุฏุฑ ุงูุจูุงูุงุช:** ูููู `OpenMultitouchSupport` ุจุงูุชูุงุท ุงูููุงุทุนุงุช ุงูุฃุฌูุฒูุฉ ูุชูููุฏ ุฃุญุฏุงุซ ุงูููุณ.
2. **ViewModel:** ูุณุชูุจู `ScaleViewModel` ุงูุจูุงูุงุช ุนุจุฑ ุงูุชุฏูู ุบูุฑ ุงููุชุฒุงูู (`for await`)ุ ููููู ุจุชูููู ุงูุถูุถุงุก ูุชุญููู ุงูููู (ุงูุถุบุท 0.0~1.0 โ ุงูุตูุช 0.0~100.0).
3. **View:** ููุชุดู SwiftUI ุชุบููุฑุงุช ุฎุงุตูุฉ `@Published` ููุนุฑุถ "ุฑุณูู ูุชุญุฑูุฉ ุชุจุฏู ุซูููุฉ".
4. **ุงููุธุงู:** ูููู ุจุชุญุฏูุซ ุตูุช ุงููุธุงู ูู ุงูุฎูููุฉ ูู ููุณ ุงูููุช.

### ุญูู ุงูุชุจุนูุฉ (DI)

ุชู ุชุตููู ViewModels ูููุงุจููุฉ ููุงุฎุชุจุงุฑ:

<div dir="ltr">

```swift
// ุงูุฅูุชุงุฌ (ุงูุงูุชุฑุงุถู)
let viewModel = ScaleViewModel() // ูุณุชุฎุฏู OMSManager.shared

// ุงูุงุฎุชุจุงุฑ
let mockProvider = MockTouchDataProvider()
let viewModel = ScaleViewModel(touchProvider: mockProvider)
```

</div>

---

## ูููู ุงููุดุฑูุน

<div dir="ltr">

```
volumeControlWithTrackWeight/
โโโ TrackWeight/                    # ุงูุชุทุจูู ุงูุฑุฆูุณู
โ   โโโ TrackWeightApp.swift        # ููุทุฉ ุงูุฏุฎูู
โ   โโโ ContentView.swift           # ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ
โ   โโโ ScaleView.swift             # ูุงุฌูุฉ ุงูููุฒุงู
โ   โโโ ScaleViewModel.swift        # ููุทู ุงูููุฒุงู
โ   โโโ WeighingView.swift          # ูุงุฌูุฉ ุงููุฒู
โ   โโโ WeighingViewModel.swift     # ุณูุฑ ุนูู ุงููุฒู
โ   โโโ WeighingState.swift         # ุชุนุฑููุงุช ุงูุญุงูุฉ
โ   โโโ TouchDataProviding.swift    # ุจุฑูุชูููู DI
โ
โโโ TrackWeightTests/               # ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ
โ   โโโ Mocks/
โ   โ   โโโ MockTouchDataProvider.swift
โ   โโโ ScaleViewModelTests.swift
โ   โโโ WeighingViewModelTests.swift
โ   โโโ WeighingStateTests.swift
โ
โโโ CLAUDE.md                       # ุฅุฑุดุงุฏุงุช ุงูุชุทููุฑ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
โโโ README.md
```

</div>

---

## ูุฑุต ุงูุชุนูู (For Engineers)

ูููููุฉ ุงูุฃูููุ ูุฐุง ูุฌุฑุฏ ุชุทุจูู ููุงููุ ูููู ูุญุชูู ุนูู ุชุญุฏูุงุช ุชูููุฉ ูุชูุฏูุฉ. ููููุฏุณ Swiftุ ููููู ุชุนูู ูุง ููู ุนูููุงู:

### 1. ูุงุฌูุงุช ุจุฑูุฌุฉ Apple ุงูุฎุงุตุฉ ูุงูุชุญูู ูู ุงูุฃุฌูุฒุฉ

ุชุนูู ููููุฉ ุชุญููู ูุงุณุชุฎุฏุงู ุงูุฅุทุงุฑ ุงูุฎุงุต `OpenMultitouchSupport` ูููุตูู ุฅูู ุจูุงูุงุช ููุญุฉ ุงูุชุชุจุน ุงูุฎุงู (ุงูุถุบุทุ ูุณุงุญุฉ ุงูุชูุงูุณ) ุงูุชู ุนุงุฏุฉู ูุง ูููู ุงููุตูู ุฅูููุง.

- **ุงููููุงุช ุงูุฑุฆูุณูุฉ:** `ContentViewModel.swift`ุ `TouchDataProviding.swift`

### 2. ุงูุชุฒุงูู ุงูุญุฏูุซ ูู Swift (Async/Await)

ูุนุงูุฌุฉ ูุนุงูุฉ ูุชุฏููุงุช ุงูุจูุงูุงุช ุงููุณุชูุฑุฉ ูู ุงููุณุชุดุนุฑุงุช ุจุงุณุชุฎุฏุงู ุฃุญุฏุซ ูููุฐุฌ ุชุฒุงูู ูู Swift 6.0.

- ูุฑุงูุจุฉ ุงูุฃุญุฏุงุซ ุจุงุณุชุฎุฏุงู `AsyncStream`
- ุฑุจุท ุจูุงูุงุช ุขูู ูุฎูุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ุจุงุณุชุฎุฏุงู `Task` ู `@MainActor`
- **ุงููููุงุช ุงูุฑุฆูุณูุฉ:** `ScaleViewModel.swift`ุ `WeighingViewModel.swift`

### 3. ูุนุงูุฌุฉ ุงูุฅุดุงุฑุงุช

ููู ุงููุณุชุดุนุฑ ุงูุฎุงู ุชุชุฐุจุฐุจ ุจุงุณุชูุฑุงุฑ (ุถูุถุงุก). ูุชุถูู ุชุทุจููุงุช ุฎูุงุฑุฒููุงุช ูุชุญููู ูุฐุง ุฅูู ุชุบููุฑุงุช ุตูุช ุณูุณุฉ ููุฑูุญุฉ.

| ุงููุนุงูู | ุงููููุฉ | ุงููุตู |
|---------|--------|-------|
| `historySize` | 10 | ุญุฌู ูุงูุฐุฉ ุงููุชูุณุท ุงููุชุญุฑู |
| `rateOfChangeThreshold` | 5.0 | ุนุชุจุฉ ูุนุฏู ุงูุชุดุงู ุงููุงุฆู |
| `stabilityThreshold` | 2.0 | ุชุญูู ุญูู ุงูุงุณุชูุฑุงุฑ |
| `fingerHoldDuration` | 3.0 ุซุงููุฉ | ููุช ุงูุชุธุงุฑ ุงูุชุดุงู ุงูุฅุตุจุน |
| `stabilityDuration` | 3.0 ุซุงููุฉ | ููุช ุงูุชุธุงุฑ ุงูุงุณุชูุฑุงุฑ |

- **ุงููููุงุช ุงูุฑุฆูุณูุฉ:** `WeighingViewModel.swift`

### 4. ุชูุงูู ูุธุงู macOS

ุชุนุฑู ุนูู ุงูุชูุงูู ูุน `AudioToolbox` ู `Core Audio` ููุชุญูู ูู ุงูุตูุช ุงูุฑุฆูุณู ุนูู ูุณุชูู ุงููุธุงูุ ูุฅุฏุงุฑุฉ ุงูุฃุฐููุงุช ูู ุจูุฆุงุช sandbox (`entitlements`).

### 5. ุงูุจููุฉ ุงููุงุจูุฉ ููุงุฎุชุจุงุฑ

ุชุนูู ุฃููุงุท ุงูุชุตููู ุงูุชู ุชูููู ุงุฎุชุจุงุฑ ุงููุญุฏุฉ ุญุชู ููููุฏ ุงูุฐู ูุนุชูุฏ ุนูู ูุงุฌูุงุช ุจุฑูุฌุฉ ุฎุงุตุฉ ูู ุฎูุงู ุชุฌุฑูุฏ ุงูุจุฑูุชูููู ูุญูู ุงูุชุจุนูุฉ.

<div dir="ltr">

```swift
protocol TouchDataProviding: AnyObject, Sendable {
    var touchDataStream: AsyncStream<[OMSTouchData]> { get }
    @MainActor func startListening() -> Bool
    @MainActor func stopListening() -> Bool
}
```

</div>

---

## ุงููุณุงููุฉ

1. ูู ุจุนูู Fork ููุฐุง ุงููุณุชูุฏุน
2. ุฃูุดุฆ ูุฑุน ููุฒุฉ (`git checkout -b feature/amazing-feature`)
3. **ุงูุชุจ ุงูุงุฎุชุจุงุฑุงุช ุฃููุงู** ูุจู ุงูุชูููุฐ
4. ุชุฃูุฏ ูู ูุฌุงุญ ุฌููุน ุงูุงุฎุชุจุงุฑุงุช (`xcodebuild test ...`)
5. ูู ุจุชุซุจูุช ุชุบููุฑุงุชู (`git commit -m 'Add amazing feature'`)
6. ุงุฏูุน ุงููุฑุน (`git push origin feature/amazing-feature`)
7. ุฃูุดุฆ Pull Request

---

## ุฅุฎูุงุก ุงููุณุคูููุฉ

> **ุชุญุฐูุฑ:** ูุง ุชุถุน ุฃุดูุงุก ุซูููุฉ ุฌุฏุงู ุฃู ุญุงุฏุฉ ุนูู ููุญุฉ ุงูุชุชุจุน. ูุฏ ูุคุฏู ุฐูู ุฅูู ุฅุชูุงู ููุญุฉ ุงูุชุชุจุน ุงูุฎุงุตุฉ ุจู. ูุง ูุชุญูู ุงููุทูุฑ ุฃู ูุณุคูููุฉ ุนู ุฃู ุฃุถุฑุงุฑ ูู ุงูุฃุฌูุฒุฉ ูุงุชุฌุฉ ุนู ุงุณุชุฎุฏุงู ูุฐุง ุงูุชุทุจูู.

**ูุฐู ูุฒุญุฉ. ูู ูุถูู ูุง ุชุณุชุฎุฏููุง ููุฃูุดุทุฉ ุงูููููุฉ.**

---

## ุงูุชุฑุฎูุต

MIT License - ุฑุงุฌุน [LICENSE](../../LICENSE) ููุชูุงุตูู.

</div>
